\section{Conclusion}

%This thesis work has presented a method for generating association rules from Carat dataset in order to estimate how mobile device system settings and context factors impact the level of energy consumption of a mobile device when using a particular mobile application. These association rules reveal non-trivial and perhaps unexpected connections between these settings and context factor and the level of energy consumption within the context of multiple mobile applications. For some reason, the generated association rules that predict low levels of energy consumption, seem to have much higher confidence than the rules which predict high levels energy consumption. This may be due to various reasons. One reason might be, that while the association analysis seems to be able to capture at least some circumstances which consistently lead to low energy consumption, the system settings and context variables available within the Carat dataset are inadequate for explaining unusually high energy consumption levels. It could even be, that the users whose devices have high energy consumption are generally running multiple mobile applications at the same time, which would naturally generate more noise to data points coming from those users. One could potentially test this hypothesis by adding the number of running applications to the list of variables from which the association rules are generated from. If this was the case, then one would expect to see rules where high number of running applications predicts high energy consumption. 

%Another goal of thesis work was to implement a web based interface, so that users could search these association rules easily. The implementation has two web servers that communicate to one another using a simple HTTP based API. The back end of the service resides on a Spark cluster where it can execute the analysis engine on user supplied parameters as requested. This way the data analysis can be wrapped inside a single exchange of HTTP request and response. The front end of the service handles all things related to the graphical user interface: rendering the search form, fetching the rules from the back end and rendering the results. The front end of the service can reside wherever as long as the service back end can be reached by HTTP. This two-tier architecture allows the remote use of computational resources of a Spark cluster without exposing the Spark cluster environment to potential security vulnerabilities that a globally accessible web server might impose.

%The implementations of both the data analysis and the user interface could be further improved. First of all, due to performance reasons, the data set had to be limited to around 16 GB, which is more than an order of magnitude less than the whole amount of available data. It is quite possible that the association analysis might reveal more fine grained dependencies between the context factors and system settings and the energy consumption of a device, if the analysis was performed using more of the available data. Different discretization strategies for the data might also affect the generated rules. Discretization of most numerical variables was done using quite an arbitrary number of percentiles, namely four. The implementation could easily be extended to allow the user to specify the number percentiles used in the discretization. 

%The user interface could be improved in multiple ways. The user interface does not show the units of measurement nor does it show values of the break points of the percentiles, which could give the user a clearer sense of how a certain value range of a variable compares to the average value of the variable. Rendering of the rules could also be improved. Paging of the rules should definitely be implemented because browsing through as many as thousands of rules in a single page is cumbersome. The user could also benefit from a searching and filtering functionality in the front end of the service to be able quickly find the rules that the user considers interesting. 

%This thesis work shows that the association analysis can effectively be applied to the domain of mobile device energy consumption modelling. This work also summarises the theoretical background of the state of the art methods used in association analysis and how to apply these methods using the MapReduce programming model. The performance evaluation aspect of the association rule generation process is also discussed and results of the evaluation are presented. Additional work is still needed to optimize the performance of the analysis engine and the usability of the user interface and to find out how different data discretization approaches affect the generated association rules. 

This thesis work has shows that the association analysis can effectively be applied to the domain of mobile device energy consumption modelling. Additionally, an implementation of a web based prototype for a developer API for the Carat dataset has been presented. The current state of the research of mobile device energy modelling as well as the relevant parts of the theory of association analysis have been reviewed.

The Carat data consists of samples which are collected from users of the Carat mobile application for the purpose collaborative energy modelling of mobile devices. Each sample contains a list of currently running mobile applications, energy consumption rate, CPU usage, travel distance, battery temperature, battery voltage, screen brightness, used mobile network technology, type of network,  WiFI signal strength, and WiFI connection speed of the mobile device. This thesis has described in detail each of these variables as well as the discretization and preprocessing of the data that must be performed in order to make the association rule discovery applicable. In summary, the variables have been divided to either three or four bins of equal mass. Some assumptions about the feasible range of the variables have been applied in preprocessing stage to exclude potentially corrupted data points.

This work has presented the essential theoretical background of the association analysis. It has introduced the FP-growth algorithm and the associated data structure FP-tree as a way of discovering frequent patterns from a dataset. It has also discussed how association rules can be generated from the frequent patterns without having to consider all candidate rules, giving an outline of an algorithm for pruning candidate rule search tree.

This thesis has shown how to implement a web based query engine that can be used to discover association rules based on the Carat data. The implementation has three major components, an analysis engine which handles all data analysis tasks, a back-end web server that uses the analysis engine as a service and exposes a JSON based HTTP API, and a service front-end that handles all user input and uses the API of the back-end server as a service for generating the association rules. The analysis engine has been built using Spark programming framework and specifically MLlib, a machine learning library for Spark which implements a parallel and distributed FP-growth algorithm.

The resulting association rules generated from the Carat data are somewhat promising. The analysis engine is consistently able to find high confidence rules from various different mobile applications. It seems however, that rules predicting high energy consumption are overall more rare and less confident than the rules which predict low or near average energy consumption. This thesis suggests some potential reasons as to why this may be the case. In order to evaluate the performance of the implementation, the runtime and the number generated rules has been measured as a function of the minimum confidence and minimum support thresholds of the association analysis for two popular Android mobile applications. The evaluation shows that the runtime of the analysis clearly depends on these variables, which is to be expected. While the runtime of the analysis shows a clear decreasing trend along both the minimum confidence threshold and the minimum support threshold axes, the magnitude of the analysis runtime does not change even when small values for these variables are used. A more problematic result from the usage point of view is the number of generated rules. Similarly to the runtime, it shows a clear decreasing trend along both the minimum support threshold and the minimum confidence threshold axes. Unlike the the runtime however, the number of generated rules ranges from as low as a dozen to tens of thousands. 

Further work is needed in order to improve the implementation of the search engine. The current implementation cannot handle tens of thousands of generated rules in a user friendly way. Additional methods should be considered for finding the interesting or important rules. It is also unintuitive that the user must specify the minimum support threshold and the minimum confidence threshold for the algorithm or settle with arbitrary default values. The engine should ideally be able to guess or iteratively find reasonable values for these variables based on the users preferences. Additionally, the effect of increasing or decreasing the number of discretization percentiles on the generated rules could be studied or alternatively the user could be allowed to specify the number of percentiles for each of the variables. Further optimizing the implementation or performing experiments with more computing capacity could potentially reveal more intricate association rules.                

             